function GameObject(t,e,o,n,i,s,r,a){if(this.sprite=null,this.x=0,null!=e&&(this.x=e),this.y=0,null!=o&&(this.y=o),this.classename=n,this.w=0,null!=i&&(this.w=i),this.h=0,null!=s&&(this.h=s),this.z=0,null!=a&&(this.z=a),this.r=0,null!=r&&(this.r=r),null!=t){if(this.sprite=se.loader.getAssets(t),!this.sprite instanceof Image||null==this.sprite)throw new Error("Ocorreu um erro ao carregar a imagem"+t+". Verifique o nome adicionado aos resources");(this.currentsprite=0)==this.h&&(this.h=this.sprite.height),0==this.w&&(this.w=this.sprite.width)}this.linklevel=se.mlevel.currentLevel,null!=se.mlevel.getCurrentLevel()?se.mlevel.getCurrentLevel().addObjects(this):console.warn("Impossível inserir objeto no nível atual.")}function Geometric(t,e,o,n,i,s,r,a,l){GameObject.call(this,void 0,t,e,o,n,i,a,l),(this.stroke=null)!=r&&(this.stroke=r),(this.fill=null)!=s&&(this.fill=s),this.linew=1}function Bullet(t,e,o,n,i,s,r){GameObject.call(this,t,e,o,"bullet",s,r),this.velocity=n,this.radius=i,this.nofire=["bullet","background"],this.fire=[],this.isremoving=!1,this.z=99}function Car(t,e,o,n,i){GameObject.call(this,t,e,o,"car",n,i),this.buttonup=null,this.buttondown=null,this.buttonleft=null,this.buttonright=null,this.aceleration=.1,this.desaceleration=.05,this.invertaceleration=1,this.maxSpeed=4,this.speed=1,this.setDefaultControll()}function MultDirections(t,e,o,n,i){GameObject.call(this,t,e,o,"mult",n,i),this.buttonup=null,this.buttondown=null,this.buttonleft=null,this.buttonright=null,this.aceleration=.05,this.desaceleration=.05,this.maxSpeed=2,this.speed=1,this.setDefaultControll()}function Plaftorm(t,e,o,n,i){}function Animation(t){this.sprites=t,this.currentsprite=0,this.timesprite=0}function Background(t,e,o,n,i){null==e&&(e=0),null==o&&(o=0),null==n&&(n=canvas.height),null==i&&(i=canvas.width),GameObject.call(this,t,e,o,"background",n,i),this.z=0}function Levels(t){this.objects=[],null!=t&&(this.objects=t),this.clean=!0,se.mlevel.addLevel(this)}function Sprite(t){}function Circle(t,e,o,n,i){Geometric.call(this,t,e,"rect",void 0,void 0,n,i),this.radius=o}function Rect(t,e,o,n,i,s){Geometric.call(this,t,e,"rect",n,o,i,s)}function Triangle(t,e,o,n,i){Geometric.call(this,t[0],t[1],"triangle",void 0,void 0,n,i),this.p1=t,this.p2=e,this.p3=o}function Button(t,e,o,n,i,s){this.classename="button",GameObject.call(this,t,e,o,"button",s,i),this.clickFunction=null!=n?n:function(){console.warn("Esse objeto não possui uma clickFunction")}}function DragDrop(t,e,o,n,i,s){this.classename="dragdrop",GameObject.call(this,t,e,o,"dragdrop",s,i),this.targetFunction=null!=n?n:function(){console.warn("esse objeto não possui uma targetFunction!")},this.dragdroped=!1,this.xoffset=0,this.yoffset=0}function InputText(t,e,o,n,i){GameObject.call(this,void 0,t,e,"gui"),this.text="",this.color="#FFF",this.size="10",this.size="Arial",this.isfocus=!0,null!=o&&(this.color=o),null!=n&&(this.size=n),null!=i&&(this.font=i),this.textaling="start",this.blocked=!1,this.maxsize=100,this.z=100,this.start()}function Text(t,e,o,n,i,s,r){GameObject.call(this,void 0,e,o,"gui"),this.text=t,this.color="#FFF",this.size="20",this.font="Arial",null!=n&&(this.color=n),null!=i&&(this.size=i),null!=s&&(this.font=s),this.z=100,this.callback=function(){},null!=r&&(this.callback=r),this.textaling="start"}function ManagerInputs(){this.DIREITA=!1,this.ESQUERDA=!1,this.CIMA=!1,this.BAIXO=!1,this.ESPACO=!1,this.start()}function ManagerLevel(){this.nameplayer="",this.currentLevel=-1,this.levels=[],this.score=0}function ManagerLoader(t){this.folder="assets/",this.starterfolder="resource/",this.assetsList=[],this.assetsListLoaded=[],this.checkAssetsList=0,this.callback=t}function ManagerMouse(){this.start(),this.x=0,this.y=0}function Turtle(){this.x=canvas.width/2,this.y=canvas.height/2,this.linew=1,this.pendown=!0,this.penolddown=!0,this.stakemoviment=[],this.stakealdlines=[],this.stepcurrent=0,this.velocity=10,this.isnewcommand=!0,this.color={r:0,g:0,b:0},this.imgturtle=new GameObject("turtle",0,0,"turtle",40,40),this.lastcolor="",this.changecolorup=!0,se.mlevel.getCurrentLevel().addObjects(this)}!function(){"use strict";var t=function(){this.init()};t.prototype={init:function(){var t=this||m;return t._counter=1e3,t._codecs={},t._howls=[],t._muted=!1,t._volume=1,t._canPlayEvent="canplaythrough",t._navigator="undefined"!=typeof window&&window.navigator?window.navigator:null,t.masterGain=null,t.noAudio=!1,t.usingWebAudio=!0,t.autoSuspend=!0,t.ctx=null,t.mobileAutoEnable=!0,t._setup(),t},volume:function(t){var e=this||m;if(t=parseFloat(t),e.ctx||h(),void 0!==t&&0<=t&&t<=1){if(e._volume=t,e._muted)return e;e.usingWebAudio&&e.masterGain.gain.setValueAtTime(t,m.ctx.currentTime);for(var o=0;o<e._howls.length;o++)if(!e._howls[o]._webAudio)for(var n=e._howls[o]._getSoundIds(),i=0;i<n.length;i++){var s=e._howls[o]._soundById(n[i]);s&&s._node&&(s._node.volume=s._volume*t)}return e}return e._volume},mute:function(t){var e=this||m;e.ctx||h(),e._muted=t,e.usingWebAudio&&e.masterGain.gain.setValueAtTime(t?0:e._volume,m.ctx.currentTime);for(var o=0;o<e._howls.length;o++)if(!e._howls[o]._webAudio)for(var n=e._howls[o]._getSoundIds(),i=0;i<n.length;i++){var s=e._howls[o]._soundById(n[i]);s&&s._node&&(s._node.muted=!!t||s._muted)}return e},unload:function(){for(var t=this||m,e=t._howls.length-1;0<=e;e--)t._howls[e].unload();return t.usingWebAudio&&t.ctx&&void 0!==t.ctx.close&&(t.ctx.close(),t.ctx=null,h()),t},codecs:function(t){return(this||m)._codecs[t.replace(/^x-/,"")]},_setup:function(){var e=this||m;if(e.state=e.ctx&&e.ctx.state||"running",e._autoSuspend(),!e.usingWebAudio)if("undefined"!=typeof Audio)try{void 0===(new Audio).oncanplaythrough&&(e._canPlayEvent="canplay")}catch(t){e.noAudio=!0}else e.noAudio=!0;try{(new Audio).muted&&(e.noAudio=!0)}catch(e){}return e.noAudio||e._setupCodecs(),e},_setupCodecs:function(){var e=this||m,t=null;try{t="undefined"!=typeof Audio?new Audio:null}catch(t){return e}if(!t||"function"!=typeof t.canPlayType)return e;var o=t.canPlayType("audio/mpeg;").replace(/^no$/,""),n=e._navigator&&e._navigator.userAgent.match(/OPR\/([0-6].)/g),i=n&&parseInt(n[0].split("/")[1],10)<33;return e._codecs={mp3:!(i||!o&&!t.canPlayType("audio/mp3;").replace(/^no$/,"")),mpeg:!!o,opus:!!t.canPlayType('audio/ogg; codecs="opus"').replace(/^no$/,""),ogg:!!t.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),oga:!!t.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),wav:!!t.canPlayType('audio/wav; codecs="1"').replace(/^no$/,""),aac:!!t.canPlayType("audio/aac;").replace(/^no$/,""),caf:!!t.canPlayType("audio/x-caf;").replace(/^no$/,""),m4a:!!(t.canPlayType("audio/x-m4a;")||t.canPlayType("audio/m4a;")||t.canPlayType("audio/aac;")).replace(/^no$/,""),mp4:!!(t.canPlayType("audio/x-mp4;")||t.canPlayType("audio/mp4;")||t.canPlayType("audio/aac;")).replace(/^no$/,""),weba:!!t.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,""),webm:!!t.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,""),dolby:!!t.canPlayType('audio/mp4; codecs="ec-3"').replace(/^no$/,""),flac:!!(t.canPlayType("audio/x-flac;")||t.canPlayType("audio/flac;")).replace(/^no$/,"")},e},_enableMobileAudio:function(){var e=this||m,t=/iPhone|iPad|iPod|Android|BlackBerry|BB10|Silk|Mobi/i.test(e._navigator&&e._navigator.userAgent),o=!!("ontouchend"in window||e._navigator&&0<e._navigator.maxTouchPoints||e._navigator&&0<e._navigator.msMaxTouchPoints);if(!e._mobileEnabled&&e.ctx&&(t||o)){e._mobileEnabled=!1,e._mobileUnloaded||44100===e.ctx.sampleRate||(e._mobileUnloaded=!0,e.unload()),e._scratchBuffer=e.ctx.createBuffer(1,1,22050);var n=function(){m._autoResume();var t=e.ctx.createBufferSource();t.buffer=e._scratchBuffer,t.connect(e.ctx.destination),void 0===t.start?t.noteOn(0):t.start(0),"function"==typeof e.ctx.resume&&e.ctx.resume(),t.onended=function(){t.disconnect(0),e._mobileEnabled=!0,e.mobileAutoEnable=!1,document.removeEventListener("touchstart",n,!0),document.removeEventListener("touchend",n,!0)}};return document.addEventListener("touchstart",n,!0),document.addEventListener("touchend",n,!0),e}},_autoSuspend:function(){var t=this;if(t.autoSuspend&&t.ctx&&void 0!==t.ctx.suspend&&m.usingWebAudio){for(var e=0;e<t._howls.length;e++)if(t._howls[e]._webAudio)for(var o=0;o<t._howls[e]._sounds.length;o++)if(!t._howls[e]._sounds[o]._paused)return t;return t._suspendTimer&&clearTimeout(t._suspendTimer),t._suspendTimer=setTimeout(function(){t.autoSuspend&&(t._suspendTimer=null,t.state="suspending",t.ctx.suspend().then(function(){t.state="suspended",t._resumeAfterSuspend&&(delete t._resumeAfterSuspend,t._autoResume())}))},3e4),t}},_autoResume:function(){var e=this;if(e.ctx&&void 0!==e.ctx.resume&&m.usingWebAudio)return"running"===e.state&&e._suspendTimer?(clearTimeout(e._suspendTimer),e._suspendTimer=null):"suspended"===e.state?(e.ctx.resume().then(function(){e.state="running";for(var t=0;t<e._howls.length;t++)e._howls[t]._emit("resume")}),e._suspendTimer&&(clearTimeout(e._suspendTimer),e._suspendTimer=null)):"suspending"===e.state&&(e._resumeAfterSuspend=!0),e}};var m=new t,e=function(t){t.src&&0!==t.src.length?this.init(t):console.error("An array of source files must be passed with any new Howl.")};e.prototype={init:function(t){var e=this;return m.ctx||h(),e._autoplay=t.autoplay||!1,e._format="string"!=typeof t.format?t.format:[t.format],e._html5=t.html5||!1,e._muted=t.mute||!1,e._loop=t.loop||!1,e._pool=t.pool||5,e._preload="boolean"!=typeof t.preload||t.preload,e._rate=t.rate||1,e._sprite=t.sprite||{},e._src="string"!=typeof t.src?t.src:[t.src],e._volume=void 0!==t.volume?t.volume:1,e._xhrWithCredentials=t.xhrWithCredentials||!1,e._duration=0,e._state="unloaded",e._sounds=[],e._endTimers={},e._queue=[],e._playLock=!1,e._onend=t.onend?[{fn:t.onend}]:[],e._onfade=t.onfade?[{fn:t.onfade}]:[],e._onload=t.onload?[{fn:t.onload}]:[],e._onloaderror=t.onloaderror?[{fn:t.onloaderror}]:[],e._onplayerror=t.onplayerror?[{fn:t.onplayerror}]:[],e._onpause=t.onpause?[{fn:t.onpause}]:[],e._onplay=t.onplay?[{fn:t.onplay}]:[],e._onstop=t.onstop?[{fn:t.onstop}]:[],e._onmute=t.onmute?[{fn:t.onmute}]:[],e._onvolume=t.onvolume?[{fn:t.onvolume}]:[],e._onrate=t.onrate?[{fn:t.onrate}]:[],e._onseek=t.onseek?[{fn:t.onseek}]:[],e._onresume=[],e._webAudio=m.usingWebAudio&&!e._html5,void 0!==m.ctx&&m.ctx&&m.mobileAutoEnable&&m._enableMobileAudio(),m._howls.push(e),e._autoplay&&e._queue.push({event:"play",action:function(){e.play()}}),e._preload&&e.load(),e},load:function(){var t=this,e=null;if(!m.noAudio){"string"==typeof t._src&&(t._src=[t._src]);for(var o=0;o<t._src.length;o++){var n,i;if(t._format&&t._format[o])n=t._format[o];else{if("string"!=typeof(i=t._src[o])){t._emit("loaderror",null,"Non-string found in selected audio sources - ignoring.");continue}(n=/^data:audio\/([^;,]+);/i.exec(i))||(n=/\.([^.]+)$/.exec(i.split("?",1)[0])),n&&(n=n[1].toLowerCase())}if(n||console.warn('No file extension was found. Consider using the "format" property or specify an extension.'),n&&m.codecs(n)){e=t._src[o];break}}return e?(t._src=e,t._state="loading","https:"===window.location.protocol&&"http:"===e.slice(0,5)&&(t._html5=!0,t._webAudio=!1),new s(t),t._webAudio&&a(t),t):void t._emit("loaderror",null,"No codec support for selected audio sources.")}t._emit("loaderror",null,"No audio support.")},play:function(o,n){var i=this,t=null;if("number"==typeof o)t=o,o=null;else{if("string"==typeof o&&"loaded"===i._state&&!i._sprite[o])return null;if(void 0===o){o="__default";for(var e=0,s=0;s<i._sounds.length;s++)i._sounds[s]._paused&&!i._sounds[s]._ended&&(e++,t=i._sounds[s]._id);1===e?o=null:t=null}}var r=t?i._soundById(t):i._inactiveSound();if(!r)return null;if(t&&!o&&(o=r._sprite||"__default"),"loaded"!==i._state){r._sprite=o,r._ended=!1;var a=r._id;return i._queue.push({event:"play",action:function(){i.play(a)}}),a}if(t&&!r._paused)return n||i._loadQueue("play"),r._id;i._webAudio&&m._autoResume();var l=Math.max(0,0<r._seek?r._seek:i._sprite[o][0]/1e3),u=Math.max(0,(i._sprite[o][0]+i._sprite[o][1])/1e3-l),c=1e3*u/Math.abs(r._rate);r._paused=!1,r._ended=!1,r._sprite=o,r._seek=l,r._start=i._sprite[o][0]/1e3,r._stop=(i._sprite[o][0]+i._sprite[o][1])/1e3,r._loop=!(!r._loop&&!i._sprite[o][2]);var h=r._node;if(i._webAudio){var d=function(){i._refreshBuffer(r);var t=r._muted||i._muted?0:r._volume;h.gain.setValueAtTime(t,m.ctx.currentTime),r._playStart=m.ctx.currentTime,void 0===h.bufferSource.start?r._loop?h.bufferSource.noteGrainOn(0,l,86400):h.bufferSource.noteGrainOn(0,l,u):r._loop?h.bufferSource.start(0,l,86400):h.bufferSource.start(0,l,u),c!==1/0&&(i._endTimers[r._id]=setTimeout(i._ended.bind(i,r),c)),n||setTimeout(function(){i._emit("play",r._id)},0)};"running"===m.state?d():(i.once("resume",d),i._clearTimer(r._id))}else{var p=function(){h.currentTime=l,h.muted=r._muted||i._muted||m._muted||h.muted,h.volume=r._volume*m.volume(),h.playbackRate=r._rate;try{var t=h.play();if("undefined"!=typeof Promise&&t instanceof Promise){i._playLock=!0;var e=function(){i._playLock=!1,n||i._emit("play",r._id)};t.then(e,e)}else n||i._emit("play",r._id);if(h.playbackRate=r._rate,h.paused)return void i._emit("playerror",r._id,"Playback was unable to start. This is most commonly an issue on mobile devices where playback was not within a user interaction.");"__default"!==o||r._loop?i._endTimers[r._id]=setTimeout(i._ended.bind(i,r),c):(i._endTimers[r._id]=function(){i._ended(r),h.removeEventListener("ended",i._endTimers[r._id],!1)},h.addEventListener("ended",i._endTimers[r._id],!1))}catch(t){i._emit("playerror",r._id,t)}},f=window&&window.ejecta||!h.readyState&&m._navigator.isCocoonJS;if(3<=h.readyState||f)p();else{var _=function(){p(),h.removeEventListener(m._canPlayEvent,_,!1)};h.addEventListener(m._canPlayEvent,_,!1),i._clearTimer(r._id)}}return r._id},pause:function(t){var e=this;if("loaded"!==e._state||e._playLock)return e._queue.push({event:"pause",action:function(){e.pause(t)}}),e;for(var o=e._getSoundIds(t),n=0;n<o.length;n++){e._clearTimer(o[n]);var i=e._soundById(o[n]);if(i&&!i._paused&&(i._seek=e.seek(o[n]),i._rateSeek=0,i._paused=!0,e._stopFade(o[n]),i._node))if(e._webAudio){if(!i._node.bufferSource)continue;void 0===i._node.bufferSource.stop?i._node.bufferSource.noteOff(0):i._node.bufferSource.stop(0),e._cleanBuffer(i._node)}else isNaN(i._node.duration)&&i._node.duration!==1/0||i._node.pause();arguments[1]||e._emit("pause",i?i._id:null)}return e},stop:function(t,e){var o=this;if("loaded"!==o._state)return o._queue.push({event:"stop",action:function(){o.stop(t)}}),o;for(var n=o._getSoundIds(t),i=0;i<n.length;i++){o._clearTimer(n[i]);var s=o._soundById(n[i]);s&&(s._seek=s._start||0,s._rateSeek=0,s._paused=!0,s._ended=!0,o._stopFade(n[i]),s._node&&(o._webAudio?s._node.bufferSource&&(void 0===s._node.bufferSource.stop?s._node.bufferSource.noteOff(0):s._node.bufferSource.stop(0),o._cleanBuffer(s._node)):isNaN(s._node.duration)&&s._node.duration!==1/0||(s._node.currentTime=s._start||0,s._node.pause())),e||o._emit("stop",s._id))}return o},mute:function(t,e){var o=this;if("loaded"!==o._state)return o._queue.push({event:"mute",action:function(){o.mute(t,e)}}),o;if(void 0===e){if("boolean"!=typeof t)return o._muted;o._muted=t}for(var n=o._getSoundIds(e),i=0;i<n.length;i++){var s=o._soundById(n[i]);s&&(s._muted=t,s._interval&&o._stopFade(s._id),o._webAudio&&s._node?s._node.gain.setValueAtTime(t?0:s._volume,m.ctx.currentTime):s._node&&(s._node.muted=!!m._muted||t),o._emit("mute",s._id))}return o},volume:function(){var t,e,o,n=this,i=arguments;if(0===i.length)return n._volume;if(1===i.length||2===i.length&&void 0===i[1]?0<=n._getSoundIds().indexOf(i[0])?e=parseInt(i[0],10):t=parseFloat(i[0]):2<=i.length&&(t=parseFloat(i[0]),e=parseInt(i[1],10)),!(void 0!==t&&0<=t&&t<=1))return(o=e?n._soundById(e):n._sounds[0])?o._volume:0;if("loaded"!==n._state)return n._queue.push({event:"volume",action:function(){n.volume.apply(n,i)}}),n;void 0===e&&(n._volume=t),e=n._getSoundIds(e);for(var s=0;s<e.length;s++)(o=n._soundById(e[s]))&&(o._volume=t,i[2]||n._stopFade(e[s]),n._webAudio&&o._node&&!o._muted?o._node.gain.setValueAtTime(t,m.ctx.currentTime):o._node&&!o._muted&&(o._node.volume=t*m.volume()),n._emit("volume",o._id));return n},fade:function(t,e,o,n){var i=this;if("loaded"!==i._state)return i._queue.push({event:"fade",action:function(){i.fade(t,e,o,n)}}),i;i.volume(t,n);for(var s=i._getSoundIds(n),r=0;r<s.length;r++){var a=i._soundById(s[r]);if(a){if(n||i._stopFade(s[r]),i._webAudio&&!a._muted){var l=m.ctx.currentTime,u=l+o/1e3;a._volume=t,a._node.gain.setValueAtTime(t,l),a._node.gain.linearRampToValueAtTime(e,u)}i._startFadeInterval(a,t,e,o,s[r],void 0===n)}}return i},_startFadeInterval:function(e,o,n,i,t,s){var r=this,a=o,l=n-o,u=Math.abs(l/.01),c=Math.max(4,0<u?i/u:i),h=Date.now();e._fadeTo=n,e._interval=setInterval(function(){var t=(Date.now()-h)/i;h=Date.now(),a+=l*t,a=Math.max(0,a),a=Math.min(1,a),a=Math.round(100*a)/100,r._webAudio?e._volume=a:r.volume(a,e._id,!0),s&&(r._volume=a),(n<o&&a<=n||o<n&&n<=a)&&(clearInterval(e._interval),e._interval=null,e._fadeTo=null,r.volume(n,e._id),r._emit("fade",e._id))},c)},_stopFade:function(t){var e=this,o=e._soundById(t);return o&&o._interval&&(e._webAudio&&o._node.gain.cancelScheduledValues(m.ctx.currentTime),clearInterval(o._interval),o._interval=null,e.volume(o._fadeTo,t),o._fadeTo=null,e._emit("fade",t)),e},loop:function(){var t,e,o,n=this,i=arguments;if(0===i.length)return n._loop;if(1===i.length){if("boolean"!=typeof i[0])return!!(o=n._soundById(parseInt(i[0],10)))&&o._loop;t=i[0],n._loop=t}else 2===i.length&&(t=i[0],e=parseInt(i[1],10));for(var s=n._getSoundIds(e),r=0;r<s.length;r++)(o=n._soundById(s[r]))&&(o._loop=t,n._webAudio&&o._node&&o._node.bufferSource&&((o._node.bufferSource.loop=t)&&(o._node.bufferSource.loopStart=o._start||0,o._node.bufferSource.loopEnd=o._stop)));return n},rate:function(){var t,e,o,n=this,i=arguments;if(0===i.length)e=n._sounds[0]._id;else if(1===i.length){0<=n._getSoundIds().indexOf(i[0])?e=parseInt(i[0],10):t=parseFloat(i[0])}else 2===i.length&&(t=parseFloat(i[0]),e=parseInt(i[1],10));if("number"!=typeof t)return(o=n._soundById(e))?o._rate:n._rate;if("loaded"!==n._state)return n._queue.push({event:"rate",action:function(){n.rate.apply(n,i)}}),n;void 0===e&&(n._rate=t),e=n._getSoundIds(e);for(var s=0;s<e.length;s++)if(o=n._soundById(e[s])){o._rateSeek=n.seek(e[s]),o._playStart=n._webAudio?m.ctx.currentTime:o._playStart,o._rate=t,n._webAudio&&o._node&&o._node.bufferSource?o._node.bufferSource.playbackRate.setValueAtTime(t,m.ctx.currentTime):o._node&&(o._node.playbackRate=t);var r=n.seek(e[s]),a=1e3*((n._sprite[o._sprite][0]+n._sprite[o._sprite][1])/1e3-r)/Math.abs(o._rate);!n._endTimers[e[s]]&&o._paused||(n._clearTimer(e[s]),n._endTimers[e[s]]=setTimeout(n._ended.bind(n,o),a)),n._emit("rate",o._id)}return n},seek:function(){var t,e,o=this,n=arguments;if(0===n.length)e=o._sounds[0]._id;else if(1===n.length){0<=o._getSoundIds().indexOf(n[0])?e=parseInt(n[0],10):o._sounds.length&&(e=o._sounds[0]._id,t=parseFloat(n[0]))}else 2===n.length&&(t=parseFloat(n[0]),e=parseInt(n[1],10));if(void 0===e)return o;if("loaded"!==o._state)return o._queue.push({event:"seek",action:function(){o.seek.apply(o,n)}}),o;var i=o._soundById(e);if(i){if(!("number"==typeof t&&0<=t)){if(o._webAudio){var s=o.playing(e)?m.ctx.currentTime-i._playStart:0,r=i._rateSeek?i._rateSeek-i._seek:0;return i._seek+(r+s*Math.abs(i._rate))}return i._node.currentTime}var a=o.playing(e);if(a&&o.pause(e,!0),i._seek=t,i._ended=!1,o._clearTimer(e),a&&o.play(e,!0),!o._webAudio&&i._node&&(i._node.currentTime=t),a&&!o._webAudio){var l=function(){o._playLock?setTimeout(l,0):o._emit("seek",e)};setTimeout(l,0)}else o._emit("seek",e)}return o},playing:function(t){if("number"==typeof t){var e=this._soundById(t);return!!e&&!e._paused}for(var o=0;o<this._sounds.length;o++)if(!this._sounds[o]._paused)return!0;return!1},duration:function(t){var e=this._duration,o=this._soundById(t);return o&&(e=this._sprite[o._sprite][1]/1e3),e},state:function(){return this._state},unload:function(){for(var t=this,e=t._sounds,o=0;o<e.length;o++){e[o]._paused||t.stop(e[o]._id),t._webAudio||(/MSIE |Trident\//.test(m._navigator&&m._navigator.userAgent)||(e[o]._node.src="data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEARKwAAIhYAQACABAAAABkYXRhAgAAAAEA"),e[o]._node.removeEventListener("error",e[o]._errorFn,!1),e[o]._node.removeEventListener(m._canPlayEvent,e[o]._loadFn,!1)),delete e[o]._node,t._clearTimer(e[o]._id);var n=m._howls.indexOf(t);0<=n&&m._howls.splice(n,1)}var i=!0;for(o=0;o<m._howls.length;o++)if(m._howls[o]._src===t._src){i=!1;break}return r&&i&&delete r[t._src],m.noAudio=!1,t._state="unloaded",t._sounds=[],t=null},on:function(t,e,o,n){var i=this["_on"+t];return"function"==typeof e&&i.push(n?{id:o,fn:e,once:n}:{id:o,fn:e}),this},off:function(t,e,o){var n=this,i=n["_on"+t],s=0;if("number"==typeof e&&(o=e,e=null),e||o)for(s=0;s<i.length;s++){var r=o===i[s].id;if(e===i[s].fn&&r||!e&&r){i.splice(s,1);break}}else if(t)n["_on"+t]=[];else{var a=Object.keys(n);for(s=0;s<a.length;s++)0===a[s].indexOf("_on")&&Array.isArray(n[a[s]])&&(n[a[s]]=[])}return n},once:function(t,e,o){return this.on(t,e,o,1),this},_emit:function(t,e,o){for(var n=this,i=n["_on"+t],s=i.length-1;0<=s;s--)i[s].id&&i[s].id!==e&&"load"!==t||(setTimeout(function(t){t.call(this,e,o)}.bind(n,i[s].fn),0),i[s].once&&n.off(t,i[s].fn,i[s].id));return n._loadQueue(t),n},_loadQueue:function(t){var e=this;if(0<e._queue.length){var o=e._queue[0];o.event===t&&(e._queue.shift(),e._loadQueue()),t||o.action()}return e},_ended:function(t){var e=this,o=t._sprite;if(!e._webAudio&&t._node&&!t._node.paused&&!t._node.ended&&t._node.currentTime<t._stop)return setTimeout(e._ended.bind(e,t),100),e;var n=!(!t._loop&&!e._sprite[o][2]);if(e._emit("end",t._id),!e._webAudio&&n&&e.stop(t._id,!0).play(t._id),e._webAudio&&n){e._emit("play",t._id),t._seek=t._start||0,t._rateSeek=0,t._playStart=m.ctx.currentTime;var i=1e3*(t._stop-t._start)/Math.abs(t._rate);e._endTimers[t._id]=setTimeout(e._ended.bind(e,t),i)}return e._webAudio&&!n&&(t._paused=!0,t._ended=!0,t._seek=t._start||0,t._rateSeek=0,e._clearTimer(t._id),e._cleanBuffer(t._node),m._autoSuspend()),e._webAudio||n||e.stop(t._id),e},_clearTimer:function(t){var e=this;if(e._endTimers[t]){if("function"!=typeof e._endTimers[t])clearTimeout(e._endTimers[t]);else{var o=e._soundById(t);o&&o._node&&o._node.removeEventListener("ended",e._endTimers[t],!1)}delete e._endTimers[t]}return e},_soundById:function(t){for(var e=0;e<this._sounds.length;e++)if(t===this._sounds[e]._id)return this._sounds[e];return null},_inactiveSound:function(){var t=this;t._drain();for(var e=0;e<t._sounds.length;e++)if(t._sounds[e]._ended)return t._sounds[e].reset();return new s(t)},_drain:function(){var t=this,e=t._pool,o=0,n=0;if(!(t._sounds.length<e)){for(n=0;n<t._sounds.length;n++)t._sounds[n]._ended&&o++;for(n=t._sounds.length-1;0<=n;n--){if(o<=e)return;t._sounds[n]._ended&&(t._webAudio&&t._sounds[n]._node&&t._sounds[n]._node.disconnect(0),t._sounds.splice(n,1),o--)}}},_getSoundIds:function(t){if(void 0===t){for(var e=[],o=0;o<this._sounds.length;o++)e.push(this._sounds[o]._id);return e}return[t]},_refreshBuffer:function(t){return t._node.bufferSource=m.ctx.createBufferSource(),t._node.bufferSource.buffer=r[this._src],t._panner?t._node.bufferSource.connect(t._panner):t._node.bufferSource.connect(t._node),t._node.bufferSource.loop=t._loop,t._loop&&(t._node.bufferSource.loopStart=t._start||0,t._node.bufferSource.loopEnd=t._stop),t._node.bufferSource.playbackRate.setValueAtTime(t._rate,m.ctx.currentTime),this},_cleanBuffer:function(t){if(m._scratchBuffer){t.bufferSource.onended=null,t.bufferSource.disconnect(0);try{t.bufferSource.buffer=m._scratchBuffer}catch(t){}}return t.bufferSource=null,this}};var s=function(t){this._parent=t,this.init()};s.prototype={init:function(){var t=this,e=t._parent;return t._muted=e._muted,t._loop=e._loop,t._volume=e._volume,t._rate=e._rate,t._seek=0,t._paused=!0,t._ended=!0,t._sprite="__default",t._id=++m._counter,e._sounds.push(t),t.create(),t},create:function(){var t=this,e=t._parent,o=m._muted||t._muted||t._parent._muted?0:t._volume;return e._webAudio?(t._node=void 0===m.ctx.createGain?m.ctx.createGainNode():m.ctx.createGain(),t._node.gain.setValueAtTime(o,m.ctx.currentTime),t._node.paused=!0,t._node.connect(m.masterGain)):(t._node=new Audio,t._errorFn=t._errorListener.bind(t),t._node.addEventListener("error",t._errorFn,!1),t._loadFn=t._loadListener.bind(t),t._node.addEventListener(m._canPlayEvent,t._loadFn,!1),t._node.src=e._src,t._node.preload="auto",t._node.volume=o*m.volume(),t._node.load()),t},reset:function(){var t=this,e=t._parent;return t._muted=e._muted,t._loop=e._loop,t._volume=e._volume,t._rate=e._rate,t._seek=0,t._rateSeek=0,t._paused=!0,t._ended=!0,t._sprite="__default",t._id=++m._counter,t},_errorListener:function(){var t=this;t._parent._emit("loaderror",t._id,t._node.error?t._node.error.code:0),t._node.removeEventListener("error",t._errorFn,!1)},_loadListener:function(){var t=this._parent;t._duration=Math.ceil(10*this._node.duration)/10,0===Object.keys(t._sprite).length&&(t._sprite={__default:[0,1e3*t._duration]}),"loaded"!==t._state&&(t._state="loaded",t._emit("load"),t._loadQueue()),this._node.removeEventListener(m._canPlayEvent,this._loadFn,!1)}};var r={},a=function(e){var t=e._src;if(r[t])return e._duration=r[t].duration,void c(e);if(/^data:[^;]+;base64,/.test(t)){for(var o=atob(t.split(",")[1]),n=new Uint8Array(o.length),i=0;i<o.length;++i)n[i]=o.charCodeAt(i);u(n.buffer,e)}else{var s=new XMLHttpRequest;s.open("GET",t,!0),s.withCredentials=e._xhrWithCredentials,s.responseType="arraybuffer",s.onload=function(){var t=(s.status+"")[0];"0"===t||"2"===t||"3"===t?u(s.response,e):e._emit("loaderror",null,"Failed loading audio file with status: "+s.status+".")},s.onerror=function(){e._webAudio&&(e._html5=!0,e._webAudio=!1,e._sounds=[],delete r[t],e.load())},l(s)}},l=function(e){try{e.send()}catch(t){e.onerror()}},u=function(t,e){m.ctx.decodeAudioData(t,function(t){t&&0<e._sounds.length&&(r[e._src]=t,c(e,t))},function(){e._emit("loaderror",null,"Decoding audio data failed.")})},c=function(t,e){e&&!t._duration&&(t._duration=e.duration),0===Object.keys(t._sprite).length&&(t._sprite={__default:[0,1e3*t._duration]}),"loaded"!==t._state&&(t._state="loaded",t._emit("load"),t._loadQueue())},h=function(){try{"undefined"!=typeof AudioContext?m.ctx=new AudioContext:"undefined"!=typeof webkitAudioContext?m.ctx=new webkitAudioContext:m.usingWebAudio=!1}catch(t){m.usingWebAudio=!1}var t=/iP(hone|od|ad)/.test(m._navigator&&m._navigator.platform),e=m._navigator&&m._navigator.appVersion.match(/OS (\d+)_(\d+)_?(\d+)?/),o=e?parseInt(e[1],10):null;if(t&&o&&o<9){var n=/safari/.test(m._navigator&&m._navigator.userAgent.toLowerCase());(m._navigator&&m._navigator.standalone&&!n||m._navigator&&!m._navigator.standalone&&!n)&&(m.usingWebAudio=!1)}m.usingWebAudio&&(m.masterGain=void 0===m.ctx.createGain?m.ctx.createGainNode():m.ctx.createGain(),m.masterGain.gain.setValueAtTime(m._muted?0:1,m.ctx.currentTime),m.masterGain.connect(m.ctx.destination)),m._setup()};"function"==typeof define&&define.amd&&define([],function(){return{Howler:m,Howl:e}}),"undefined"!=typeof exports&&(exports.Howler=m,exports.Howl=e),"undefined"!=typeof window?(window.HowlerGlobal=t,window.Howler=m,window.Howl=e,window.Audio=s):"undefined"!=typeof global&&(global.HowlerGlobal=t,global.Howler=m,global.Howl=e,global.Audio=s)}(),function(){"use strict";var e,o,n;HowlerGlobal.prototype._pos=[0,0,0],HowlerGlobal.prototype._orientation=[0,0,-1,0,1,0],HowlerGlobal.prototype.stereo=function(t){var e=this;if(!e.ctx||!e.ctx.listener)return e;for(var o=e._howls.length-1;0<=o;o--)e._howls[o].stereo(t);return e},HowlerGlobal.prototype.pos=function(t,e,o){var n=this;return n.ctx&&n.ctx.listener?(e="number"!=typeof e?n._pos[1]:e,o="number"!=typeof o?n._pos[2]:o,"number"!=typeof t?n._pos:(n._pos=[t,e,o],void 0!==n.ctx.listener.positionX?(n.ctx.listener.positionX.setTargetAtTime(n._pos[0],Howler.ctx.currentTime,.1),n.ctx.listener.positionY.setTargetAtTime(n._pos[1],Howler.ctx.currentTime,.1),n.ctx.listener.positionZ.setTargetAtTime(n._pos[2],Howler.ctx.currentTime,.1)):n.ctx.listener.setPosition(n._pos[0],n._pos[1],n._pos[2]),n)):n},HowlerGlobal.prototype.orientation=function(t,e,o,n,i,s){var r=this;if(!r.ctx||!r.ctx.listener)return r;var a=r._orientation;return e="number"!=typeof e?a[1]:e,o="number"!=typeof o?a[2]:o,n="number"!=typeof n?a[3]:n,i="number"!=typeof i?a[4]:i,s="number"!=typeof s?a[5]:s,"number"!=typeof t?a:(r._orientation=[t,e,o,n,i,s],void 0!==r.ctx.listener.forwardX?(r.ctx.listener.forwardX.setTargetAtTime(t,Howler.ctx.currentTime,.1),r.ctx.listener.forwardY.setTargetAtTime(e,Howler.ctx.currentTime,.1),r.ctx.listener.forwardZ.setTargetAtTime(o,Howler.ctx.currentTime,.1),r.ctx.listener.upX.setTargetAtTime(t,Howler.ctx.currentTime,.1),r.ctx.listener.upY.setTargetAtTime(e,Howler.ctx.currentTime,.1),r.ctx.listener.upZ.setTargetAtTime(o,Howler.ctx.currentTime,.1)):r.ctx.listener.setOrientation(t,e,o,n,i,s),r)},Howl.prototype.init=(n=Howl.prototype.init,function(t){var e=this;return e._orientation=t.orientation||[1,0,0],e._stereo=t.stereo||null,e._pos=t.pos||null,e._pannerAttr={coneInnerAngle:void 0!==t.coneInnerAngle?t.coneInnerAngle:360,coneOuterAngle:void 0!==t.coneOuterAngle?t.coneOuterAngle:360,coneOuterGain:void 0!==t.coneOuterGain?t.coneOuterGain:0,distanceModel:void 0!==t.distanceModel?t.distanceModel:"inverse",maxDistance:void 0!==t.maxDistance?t.maxDistance:1e4,panningModel:void 0!==t.panningModel?t.panningModel:"HRTF",refDistance:void 0!==t.refDistance?t.refDistance:1,rolloffFactor:void 0!==t.rolloffFactor?t.rolloffFactor:1},e._onstereo=t.onstereo?[{fn:t.onstereo}]:[],e._onpos=t.onpos?[{fn:t.onpos}]:[],e._onorientation=t.onorientation?[{fn:t.onorientation}]:[],n.call(this,t)}),Howl.prototype.stereo=function(t,e){var o=this;if(!o._webAudio)return o;if("loaded"!==o._state)return o._queue.push({event:"stereo",action:function(){o.stereo(t,e)}}),o;var n=void 0===Howler.ctx.createStereoPanner?"spatial":"stereo";if(void 0===e){if("number"!=typeof t)return o._stereo;o._stereo=t,o._pos=[t,0,0]}for(var i=o._getSoundIds(e),s=0;s<i.length;s++){var r=o._soundById(i[s]);if(r){if("number"!=typeof t)return r._stereo;r._stereo=t,r._pos=[t,0,0],r._node&&(r._pannerAttr.panningModel="equalpower",r._panner&&r._panner.pan||u(r,n),"spatial"===n?(r._panner.positionX.setValueAtTime(t,Howler.ctx.currentTime),r._panner.positionY.setValueAtTime(0,Howler.ctx.currentTime),r._panner.positionZ.setValueAtTime(0,Howler.ctx.currentTime)):r._panner.pan.setValueAtTime(t,Howler.ctx.currentTime)),o._emit("stereo",r._id)}}return o},Howl.prototype.pos=function(t,e,o,n){var i=this;if(!i._webAudio)return i;if("loaded"!==i._state)return i._queue.push({event:"pos",action:function(){i.pos(t,e,o,n)}}),i;if(e="number"!=typeof e?0:e,o="number"!=typeof o?-.5:o,void 0===n){if("number"!=typeof t)return i._pos;i._pos=[t,e,o]}for(var s=i._getSoundIds(n),r=0;r<s.length;r++){var a=i._soundById(s[r]);if(a){if("number"!=typeof t)return a._pos;a._pos=[t,e,o],a._node&&(a._panner&&!a._panner.pan||u(a,"spatial"),a._panner.positionX.setValueAtTime(t,Howler.ctx.currentTime),a._panner.positionY.setValueAtTime(e,Howler.ctx.currentTime),a._panner.positionZ.setValueAtTime(o,Howler.ctx.currentTime)),i._emit("pos",a._id)}}return i},Howl.prototype.orientation=function(t,e,o,n){var i=this;if(!i._webAudio)return i;if("loaded"!==i._state)return i._queue.push({event:"orientation",action:function(){i.orientation(t,e,o,n)}}),i;if(e="number"!=typeof e?i._orientation[1]:e,o="number"!=typeof o?i._orientation[2]:o,void 0===n){if("number"!=typeof t)return i._orientation;i._orientation=[t,e,o]}for(var s=i._getSoundIds(n),r=0;r<s.length;r++){var a=i._soundById(s[r]);if(a){if("number"!=typeof t)return a._orientation;a._orientation=[t,e,o],a._node&&(a._panner||(a._pos||(a._pos=i._pos||[0,0,-.5]),u(a,"spatial")),a._panner.orientationX.setValueAtTime(t,Howler.ctx.currentTime),a._panner.orientationY.setValueAtTime(e,Howler.ctx.currentTime),a._panner.orientationZ.setValueAtTime(o,Howler.ctx.currentTime)),i._emit("orientation",a._id)}}return i},Howl.prototype.pannerAttr=function(){var t,e,o,n=this,i=arguments;if(!n._webAudio)return n;if(0===i.length)return n._pannerAttr;if(1===i.length){if("object"!=typeof i[0])return(o=n._soundById(parseInt(i[0],10)))?o._pannerAttr:n._pannerAttr;t=i[0],void 0===e&&(t.pannerAttr||(t.pannerAttr={coneInnerAngle:t.coneInnerAngle,coneOuterAngle:t.coneOuterAngle,coneOuterGain:t.coneOuterGain,distanceModel:t.distanceModel,maxDistance:t.maxDistance,refDistance:t.refDistance,rolloffFactor:t.rolloffFactor,panningModel:t.panningModel}),n._pannerAttr={coneInnerAngle:void 0!==t.pannerAttr.coneInnerAngle?t.pannerAttr.coneInnerAngle:n._coneInnerAngle,coneOuterAngle:void 0!==t.pannerAttr.coneOuterAngle?t.pannerAttr.coneOuterAngle:n._coneOuterAngle,coneOuterGain:void 0!==t.pannerAttr.coneOuterGain?t.pannerAttr.coneOuterGain:n._coneOuterGain,distanceModel:void 0!==t.pannerAttr.distanceModel?t.pannerAttr.distanceModel:n._distanceModel,maxDistance:void 0!==t.pannerAttr.maxDistance?t.pannerAttr.maxDistance:n._maxDistance,refDistance:void 0!==t.pannerAttr.refDistance?t.pannerAttr.refDistance:n._refDistance,rolloffFactor:void 0!==t.pannerAttr.rolloffFactor?t.pannerAttr.rolloffFactor:n._rolloffFactor,panningModel:void 0!==t.pannerAttr.panningModel?t.pannerAttr.panningModel:n._panningModel})}else 2===i.length&&(t=i[0],e=parseInt(i[1],10));for(var s=n._getSoundIds(e),r=0;r<s.length;r++)if(o=n._soundById(s[r])){var a=o._pannerAttr;a={coneInnerAngle:void 0!==t.coneInnerAngle?t.coneInnerAngle:a.coneInnerAngle,coneOuterAngle:void 0!==t.coneOuterAngle?t.coneOuterAngle:a.coneOuterAngle,coneOuterGain:void 0!==t.coneOuterGain?t.coneOuterGain:a.coneOuterGain,distanceModel:void 0!==t.distanceModel?t.distanceModel:a.distanceModel,maxDistance:void 0!==t.maxDistance?t.maxDistance:a.maxDistance,refDistance:void 0!==t.refDistance?t.refDistance:a.refDistance,rolloffFactor:void 0!==t.rolloffFactor?t.rolloffFactor:a.rolloffFactor,panningModel:void 0!==t.panningModel?t.panningModel:a.panningModel};var l=o._panner;l?(l.coneInnerAngle=a.coneInnerAngle,l.coneOuterAngle=a.coneOuterAngle,l.coneOuterGain=a.coneOuterGain,l.distanceModel=a.distanceModel,l.maxDistance=a.maxDistance,l.refDistance=a.refDistance,l.rolloffFactor=a.rolloffFactor,l.panningModel=a.panningModel):(o._pos||(o._pos=n._pos||[0,0,-.5]),u(o,"spatial"))}return n},Audio.prototype.init=(o=Audio.prototype.init,function(){var t=this,e=t._parent;t._orientation=e._orientation,t._stereo=e._stereo,t._pos=e._pos,t._pannerAttr=e._pannerAttr,o.call(this),t._stereo?e.stereo(t._stereo):t._pos&&e.pos(t._pos[0],t._pos[1],t._pos[2],t._id)}),Audio.prototype.reset=(e=Audio.prototype.reset,function(){var t=this._parent;return this._orientation=t._orientation,this._pos=t._pos,this._pannerAttr=t._pannerAttr,e.call(this)});var u=function(t,e){"spatial"===(e=e||"spatial")?(t._panner=Howler.ctx.createPanner(),t._panner.coneInnerAngle=t._pannerAttr.coneInnerAngle,t._panner.coneOuterAngle=t._pannerAttr.coneOuterAngle,t._panner.coneOuterGain=t._pannerAttr.coneOuterGain,t._panner.distanceModel=t._pannerAttr.distanceModel,t._panner.maxDistance=t._pannerAttr.maxDistance,t._panner.refDistance=t._pannerAttr.refDistance,t._panner.rolloffFactor=t._pannerAttr.rolloffFactor,t._panner.panningModel=t._pannerAttr.panningModel,t._panner.positionX.setValueAtTime(t._pos[0],Howler.ctx.currentTime),t._panner.positionY.setValueAtTime(t._pos[1],Howler.ctx.currentTime),t._panner.positionZ.setValueAtTime(t._pos[2],Howler.ctx.currentTime),t._panner.orientationX.setValueAtTime(t._orientation[0],Howler.ctx.currentTime),t._panner.orientationY.setValueAtTime(t._orientation[1],Howler.ctx.currentTime),t._panner.orientationZ.setValueAtTime(t._orientation[2],Howler.ctx.currentTime)):(t._panner=Howler.ctx.createStereoPanner(),t._panner.pan.setValueAtTime(t._stereo,Howler.ctx.currentTime)),t._panner.connect(t._node),t._paused||t._parent.pause(t._id,!0).play(t._id,!0)}}(),GameObject.prototype.update=function(){},GameObject.prototype.print=function(){ctx.drawImage(this.sprite,this.x,this.y,this.w,this.h)},GameObject.prototype.setRotate=function(t){360<t&&(t-=360),this.r=t},GameObject.prototype.getRotate=function(){return this.r},GameObject.prototype.setPosition=function(t,e){this.x=t,this.y=e},GameObject.prototype.setPositionByObject=function(t,e){"top"==e&&(this.x=t.x+t.w/2-this.w/2,this.y=t.y-this.h)},GameObject.prototype.setWidth=function(t){this.w=t},GameObject.prototype.getWidth=function(){return this.w},GameObject.prototype.setHeight=function(t){this.h=t},GameObject.prototype.getHeight=function(){return this.h},GameObject.prototype.setSize=function(t,e){this.w=t,this.h=e},GameObject.prototype.translate=function(t,e){this.x+=t,this.y+=e},Geometric.prototype=Object.create(GameObject.prototype),Geometric.prototype.setFill=function(t){this.fill=t},Geometric.prototype.clearFill=function(){this.fill=null},Geometric.prototype.setStroke=function(t){this.stroke=t},Geometric.prototype.clearStroke=function(){this.stroke=null},Geometric.prototype.setLineWidth=function(t){this.linew=t},Geometric.prototype.getLineWidth=function(){return this.linew},Bullet.prototype=Object.create(GameObject.prototype),Bullet.prototype.setNoFire=function(t){this.nofire.push(t)},Bullet.prototype.setFire=function(t){this.fire.push(t)},Bullet.prototype.update=function(){(this.y<0||this.y>canvas.height)&&se.mlevel.levels[this.linklevel].objects.splice(se.mlevel.levels[this.linklevel].objects.indexOf(this),1),this.y+=this.velocity;for(var t=0;t<se.mlevel.getCurrentLevel().objects.length;t++)if(!this.isremoving){for(var e=se.mlevel.getCurrentLevel().objects[t],o=0;o<this.nofire.length;o++)e.classename,this.nofire[o];if(this.x+this.w>e.x&&this.x<e.x+e.w&&this.y+this.h>e.y&&this.y<e.y+e.w)for(o=0;o<this.fire.length;o++)e.classename==this.fire[o][0]&&("custom"==this.fire[o][1]?this.fire[o][2]():"kill"==this.fire[o][1]&&e.fired(),this.remove())}},Bullet.prototype.remove=function(){this.isremoving||(this.isremoving=!0,se.mlevel.removeObject(this))},Car.prototype=Object.create(GameObject.prototype),Car.prototype.print=function(){ctx.save();var t=this.x+this.w/2,e=this.y+this.h/2;ctx.translate(t,e),ctx.rotate(this.r*Math.PI/180),ctx.translate(-t,-e),ctx.drawImage(this.sprite,this.x,this.y,this.w,this.h),ctx.restore()},Car.prototype.setControll=function(t,e,o,n){this.buttondown=e,this.buttonleft=o,this.buttonright=n,this.buttonup=t},Car.prototype.setDefaultControll=function(){this.buttondown="DOWN",this.buttonleft="LEFT",this.buttonright="RIGHT",this.buttonup="UP"},Car.prototype.update=function(){this.x+=this.speed*Math.cos(this.r*Math.PI/180),this.y+=this.speed*Math.sin(this.r*Math.PI/180),se.teclado.getKey(this.buttonup)&&this.moveUp(),se.teclado.getKey(this.buttondown)&&this.moveDown(),se.teclado.getKey(this.buttonright)&&this.moveRight(),se.teclado.getKey(this.buttonleft)&&this.moveLeft(),se.teclado.ESQUERDA||se.teclado.DIREITA||se.teclado.CIMA||se.teclado.BAIXO||(0<=this.speed&&(this.speed-=this.desaceleration),this.speed<0&&(this.speed+=this.desaceleration),this.speed<.1&&-.1<this.speed&&(this.speed=0))},Car.prototype.moveUp=function(){Math.abs(this.speed)<this.maxSpeed&&(0<=this.speed&&(this.speed+=this.aceleration),this.speed<0&&(this.speed-=this.aceleration)),this.speed<0&&(this.speed=-this.speed)},Car.prototype.moveDown=function(){Math.abs(this.speed)<this.maxSpeed&&(0<=this.speed&&(this.speed+=this.aceleration),this.speed<0&&(this.speed-=this.aceleration)),0<this.speed&&(this.speed-=this.invertaceleration)},Car.prototype.moveLeft=function(){se.teclado.getKey(this.buttonup)?this.r-=1:se.teclado.getKey(this.buttondown)&&(this.r+=1)},Car.prototype.moveRight=function(){se.teclado.getKey(this.buttonup)?this.r+=1:se.teclado.getKey(this.buttondown)&&(this.r-=1)},MultDirections.prototype=Object.create(GameObject.prototype),MultDirections.prototype.print=function(){ctx.save();var t=this.x+this.w/2,e=this.y+this.h/2;ctx.translate(t,e),ctx.rotate(this.r*Math.PI/180),ctx.translate(-t,-e),ctx.drawImage(this.sprite,this.x,this.y,this.w,this.h),ctx.restore()},MultDirections.prototype.setControll=function(t,e,o,n){this.buttondown=e,this.buttonleft=o,this.buttonright=n,this.buttonup=t},MultDirections.prototype.setDefaultControll=function(){this.buttondown="DOWN",this.buttonleft="LEFT",this.buttonright="RIGHT",this.buttonup="UP"},MultDirections.prototype.update=function(){if(this.x+=this.speed*Math.cos(this.r*Math.PI/180),this.y+=this.speed*Math.sin(this.r*Math.PI/180),se.teclado.getKey(this.buttonup))if(se.teclado.getKey(this.buttonright)||se.teclado.getKey(this.buttonleft))if(se.teclado.getKey(this.buttonright))this.turnToRight();else{if(!se.teclado.getKey(this.buttonleft))return;this.turnToLetf()}else this.moveUp();if(se.teclado.getKey(this.buttondown))if(se.teclado.getKey(this.buttonright)||se.teclado.getKey(this.buttonleft))if(se.teclado.getKey(this.buttonright))this.turnToRight();else{if(!se.teclado.getKey(this.buttonleft))return;this.turnToLetf()}else this.moveDown();if(se.teclado.getKey(this.buttonright))if(se.teclado.getKey(this.buttonup)||se.teclado.getKey(this.buttondown))if(se.teclado.getKey(this.buttondown))this.turnToDown();else{if(!se.teclado.getKey(this.buttonup))return;this.turnToUp()}else this.moveRight();if(se.teclado.getKey(this.buttonleft))if(se.teclado.getKey(this.buttonup)||se.teclado.getKey(this.buttondown))if(se.teclado.getKey(this.buttondown))this.turnToDown();else{if(!se.teclado.getKey(this.buttonup))return;this.turnToUp()}else this.moveLeft();se.teclado.ESQUERDA||se.teclado.DIREITA||se.teclado.CIMA||se.teclado.BAIXO||(0<=this.speed&&(this.speed-=this.desaceleration),this.speed<0&&(this.speed+=this.desaceleration),this.speed<.1&&-.1<this.speed&&(this.speed=0))},MultDirections.prototype.moveUp=function(){270!=this.getRotate()&&this.setRotate(270),Math.abs(this.speed)<this.maxSpeed&&(this.speed+=this.aceleration)},MultDirections.prototype.moveDown=function(){90!=this.getRotate()&&this.setRotate(90),Math.abs(this.speed)<this.maxSpeed&&(this.speed+=this.aceleration)},MultDirections.prototype.moveLeft=function(){180!=this.getRotate()&&this.setRotate(180),Math.abs(this.speed)<this.maxSpeed&&(this.speed+=this.aceleration)},MultDirections.prototype.moveRight=function(){360!=this.getRotate()&&this.setRotate(360),Math.abs(this.speed)<this.maxSpeed&&(this.speed+=this.aceleration)},MultDirections.prototype.turnToRight=function(){270<=this.getRotate()&&this.getRotate()<315?this.setRotate(this.getRotate()+1):this.getRotate()<=90&&45<this.getRotate()&&this.setRotate(this.getRotate()-1)},MultDirections.prototype.turnToLetf=function(){this.getRotate()<=270&&225<this.getRotate()?this.setRotate(this.getRotate()-1):90<=this.getRotate()&&this.getRotate()<135&&this.setRotate(this.getRotate()+1)},MultDirections.prototype.turnToUp=function(){this.getRotate()<=360&&315<this.getRotate()?this.setRotate(this.getRotate()-1):180<=this.getRotate()&&this.getRotate()<225&&this.setRotate(this.getRotate()+1)},MultDirections.prototype.turnToDown=function(){console.log(this.getRotate()),360==this.getRotate()||0<this.getRotate()&&this.getRotate()<45?this.setRotate(this.getRotate()+1):this.getRotate()<=180&&135<this.getRotate()&&this.setRotate(this.getRotate()-1)},Animation.prototype.nextSprite=function(){},Animation.prototype.priorSprite=function(){},Animation.prototype.setInterval=function(){},Background.prototype=Object.create(GameObject.prototype),Background.prototype.print=function(t){var e=t.createPattern(this.sprite,"repeat");t.fillStyle=e,t.fillRect(0,0,this.w,this.h)},Levels.prototype.addObjects=function(t){this.objects.push(t)},Levels.prototype.startFunction=function(){},Levels.prototype.print=function(){this.objects.sort(function(t,e){return t.z-e.z});for(var t=0;t<this.objects.length;t++)this.objects[t].update(),null!=this.objects[t]&&this.objects[t].print(ctx)},Levels.prototype.setFunctionStart=function(t){this.startFunction=t},Levels.prototype.setObjects=function(t){this.objects=t},Levels.prototype.getObjects=function(){return this.objects},Sound=function(t){this.audio=se.loader.getAssets(t)},Sound.prototype.play=function(){this.audio.play()},Sound.prototype.playInLoop=function(){this.audio.loop()},Sound.prototype.pause=function(){this.audio.pause()},Sound.prototype.stop=function(){this.audio.stop()},Sound.prototype.setVolume=function(t){this.audio.volume(t)},Sound.prototype.isPlaying=function(){return this.audio.isPlaying()},Audio.prototype.setOnEnd=function(t){this.on("end",t)},Sprite.prototype=Object.create(GameObject.prototype),Circle.prototype=Object.create(Geometric.prototype),Circle.prototype.print=function(){var t=this.x+this.radius/2,e=this.y+this.radius/2;ctx.save(),ctx.translate(t,e),ctx.rotate(this.r*Math.PI/180),ctx.translate(-t,-e),ctx.beginPath(),ctx.arc(this.x+this.radius/2,this.y+this.radius/2,this.radius,0,2*Math.PI),null!=this.fill&&(ctx.fillStyle=this.fill,ctx.fill()),null!=this.stroke&&(ctx.strokeStyle=this.stroke,ctx.stroke()),ctx.restore()},Rect.prototype=Object.create(Geometric.prototype),Rect.prototype.print=function(){this.x,this.w,this.y,this.h;ctx.save(),ctx.translate(this.x+this.w/2,this.y+this.h/2),ctx.rotate(this.r*Math.PI/180),null!=this.fill&&(ctx.fillStyle=this.fill,ctx.fillRect(-this.w/2,-this.h/2,this.w,this.h)),null!=this.stroke&&(ctx.strokeStyle=this.stroke,ctx.lineWidth=this.linew,ctx.strokeRect(-this.w/2,-this.h/2,this.w,this.h)),ctx.restore()},Triangle.prototype=Object.create(Geometric.prototype),Triangle.prototype.print=function(){var t=(this.p1[0]+this.p2[0]+this.p3[0])/3,e=(this.p1[1]+this.p2[1]+this.p3[1])/3;ctx.fillRect(t,e,10,10),ctx.save(),ctx.translate(t,e),ctx.rotate(this.r*Math.PI/180),ctx.translate(-t,-e),ctx.beginPath(),ctx.moveTo(this.p1[0],this.p1[1]),ctx.lineTo(this.p2[0],this.p2[1]),ctx.lineTo(this.p3[0],this.p3[1]),ctx.lineTo(this.p1[0],this.p1[1]),null!=this.fill&&(ctx.fillStyle=this.fill,ctx.fill()),null!=this.stroke&&(ctx.strokeStyle=this.stroke,ctx.stroke()),ctx.restore()},Triangle.prototype.translate=function(t,e){this.p1[0]+=t,this.p2[0]+=t,this.p3[0]+=t,this.p1[1]+=e,this.p2[1]+=e,this.p3[1]+=e},Button.prototype=Object.create(GameObject.prototype),Button.prototype.click=function(){this.clickFunction()},Button.prototype.setClick=function(t){this.clickFunction=t},DragDrop.prototype=Object.create(GameObject.prototype),DragDrop.prototype.print=function(){if(this.dragdroped){var t=ctx.globalAlpha;ctx.globalAlpha=.4,this.x=se.mmouse.getMouseX()+this.xoffset,this.y=se.mmouse.getMouseY()+this.yoffset,ctx.drawImage(this.sprite,this.x,this.y,this.w,this.h),ctx.globalAlpha=t}else ctx.drawImage(this.sprite,this.x,this.y,this.w,this.h)},DragDrop.prototype.click=function(){this.dragdroped?(this.dragdroped=!1,this.xoffset=0,this.yoffset=0):(this.dragdroped=!0,this.xoffset=this.x-se.mmouse.getMouseX(),this.yoffset=this.y-se.mmouse.getMouseY())},DragDrop.prototype.target=function(){this.targetFunction()},DragDrop.prototype.setTarget=function(t){this.targetFunction=t},InputText.prototype=Object.create(GameObject.prototype),InputText.prototype.start=function(){document.addEventListener("keydown",function(t){if(!this.blocked){if(this.blocked=!0,8==event.keyCode)return void(this.text=this.text.slice(0,-1));(65<=event.keyCode&&event.keyCode<90||97<=event.keyCode&&event.keyCode<122)&&(this.text+=String.fromCharCode(t.keyCode))}}.bind(this)),document.addEventListener("keyup",function(t){this.blocked=!1}.bind(this))},InputText.prototype.print=function(){ctx.textAlign=this.textaling,ctx.fillStyle=this.color,ctx.font=this.size+"px "+this.font,ctx.fillText(this.text,this.x,this.y),ctx.beginPath(),ctx.moveTo(this.x,this.y+2),ctx.lineTo(this.x+this.maxsize,this.y+2),ctx.stroke()},InputText.prototype.setText=function(t){this.text=t},InputText.prototype.setMaxSize=function(t){this.maxsize=t},InputText.prototype.setText=function(t){this.text=t},InputText.prototype.setAling=function(t){this.textaling=t},InputText.prototype.toCenter=function(t){this.textaling="center"},InputText.prototype.toEnd=function(t){this.textaling="end"},InputText.prototype.toStart=function(t){this.textaling="start"},InputText.prototype.toLeft=function(t){this.textaling="left"},InputText.prototype.toRight=function(t){this.textaling="right"},InputText.prototype.setMaxSize=function(t){this.maxsize=t},Score=function(t,e,o,n){this.name=t,this.score=0,this.alttext=text,this.sprite=null,this.text=null,this.sprite=new GameObject(e,o,n,"guiscore"),this.text=new Text(this.score,o+this.sprite.getWidth()+10,n+this.sprite.getHeight()/2)},Score.prototype.update=function(){},Score.prototype.print=function(){this.text.setText(this.score),this.text.print(),this.sprite.print()},Text.prototype=Object.create(GameObject.prototype),Text.prototype.print=function(){ctx.textAlign=this.textaling,ctx.fillStyle=this.color,ctx.font=this.size+"px "+this.font,ctx.fillText(this.text,this.x,this.y)},Text.prototype.setText=function(t){this.text=t},Text.prototype.setAling=function(t){this.textaling=t},Text.prototype.toCenter=function(){this.textaling="center"},Text.prototype.toEnd=function(){this.textaling="end"},Text.prototype.toStart=function(){this.textaling="start"},Text.prototype.toLeft=function(){this.textaling="left"},Text.prototype.toRight=function(){this.textaling="right"},ManagerInputs.prototype.start=function(){document.addEventListener("keydown",function(t){38==t.keyCode&&(this.CIMA=!0),40==t.keyCode&&(this.BAIXO=!0),37==t.keyCode&&(this.ESQUERDA=!0),39==t.keyCode&&(this.DIREITA=!0),32==t.keyCode&&(this.ESPACO=!0)}.bind(this)),document.addEventListener("keyup",function(t){38==t.keyCode&&(this.CIMA=!1),40==t.keyCode&&(this.BAIXO=!1),37==t.keyCode&&(this.ESQUERDA=!1),39==t.keyCode&&(this.DIREITA=!1),32==t.keyCode&&(this.ESPACO=!1)}.bind(this))},ManagerInputs.prototype.getKey=function(t){return"UP"==t?this.CIMA:"DOWN"==t?this.BAIXO:"RIGHT"==t?this.DIREITA:"LEFT"==t?this.ESQUERDA:void 0},ManagerLevel.prototype.addLevel=function(t){this.levels.push(t)},ManagerLevel.prototype.loadLevel=function(t){this.currentLevel=t,this.getCurrentLevel().setObjects([]),this.getCurrentLevel().startFunction()},ManagerLevel.prototype.nextLevel=function(){this.currentLevel++,this.getCurrentLevel().setObjects([]),this.getCurrentLevel().startFunction()},ManagerLevel.prototype.priorLevel=function(){this.currentLevel--,this.getCurrentLevel().setObjects([]),this.getCurrentLevel().startFunction()},ManagerLevel.prototype.getCurrentLevel=function(){return this.levels[this.currentLevel]},ManagerLevel.prototype.print=function(){this.levels[this.currentLevel].clean&&(ctx.save(),ctx.setTransform(1,0,0,1,0,0),ctx.clearRect(0,0,canvas.width,canvas.height),ctx.restore()),this.levels[this.currentLevel].print(ctx)},ManagerLevel.prototype.getLevel=function(t){return this.levels[t]},ManagerLevel.prototype.getObjectByLevel=function(t){return this.levels[t].getObjects()},ManagerLevel.prototype.getObjectsCurrentLevel=function(){return-1!=this.currentLevel?this.levels[this.currentLevel].getObjects():[]},ManagerLevel.prototype.removeObject=function(t){this.getObjectByLevel(t.linklevel).splice(this.getObjectByLevel(t.linklevel).indexOf(t),1)},ManagerLevel.prototype.addScore=function(t){objs=this.getObjectByLevel(this.currentLevel);for(var e=0;e<objs.length;e++)objs[e].name==t&&objs[e].score++},ManagerLevel.prototype.gameOver=function(){scores=se.storage.getItemJSON("score1");for(var t=0;t<scores.length;t++)if(scores[t].score<this.score){console.log("new score"),scores[t].name=this.nameplayer,scores[t].score=this.score,se.storage.setItemJSON("score1",scores);break}this.loadLevel(0)},ManagerLevel.prototype.offDragdropFlag=function(){for(var t=this.getObjectsCurrentLevel(),e=0;e<t.length;e++)"dragdrop"==t[e].classename&&(t[e].dragdroped=!1)},ManagerLevel.prototype.createNewEnemy=function(t){enemy=new Enemy("enemyred",500*Math.random(),-50,"enemy"),enemy.aceleration=t+.2,this.levels[this.currentLevel].objects.push(enemy)},ManagerLevel.prototype.killEnemy=function(t){this.addScore("score"),this.removeObject(t),this.createNewEnemy(t.aceleration)},ManagerLoader.prototype.addResource=function(t,e,o){this.assetsList.push([t,e,o,"user"])},ManagerLoader.prototype.addStarterResource=function(t,e,o){this.assetsList.push([t,e,o,"starter"])},ManagerLoader.prototype.addImage=function(t,e){this.assetsList.push([t,e,"image","user"])},ManagerLoader.prototype.addAudio=function(t,e){this.assetsList.push([t,e,"audio","user"])},ManagerLoader.prototype.loading=function(){if(0==this.assetsList.length)return this.print(.99),void setTimeout(this.callback,2e3);for(var t=0;t<this.assetsList.length;t++)if("image"==this.assetsList[t][2]){this.assetsListLoaded.push(new Image);var e=this.assetsListLoaded[this.assetsListLoaded.length-1];e.onload=function(){this.checkAssetsList++,this.checkAssetsList==this.assetsList.length?(this.print(),setTimeout(this.callback,2e3)):this.print()}.bind(this),"user"==this.assetsList[t][3]?e.src=this.folder+this.assetsList[t][1]:e.src=this.starterfolder+this.assetsList[t][1]}else if("audio"==this.assetsList[t][2]){var o=null,n=function(){this.checkAssetsList++,this.checkAssetsList==this.assetsList.length?(this.print(),setTimeout(this.callback,2e3)):this.print()}.bind(this);o="user"==this.assetsList[t][3]?new Howl({src:[this.folder+this.assetsList[t][1]],onload:n}):new Howl({src:[this.starterfolder+this.assetsList[t][1]],onload:n}),this.assetsListLoaded.push(o)}},ManagerLoader.prototype.getAssets=function(t){for(var e=null,o=0;o<this.assetsList.length;o++)this.assetsList[o][0]==t&&(e=this.assetsListLoaded[o]);return e},ManagerLoader.prototype.print=function(t){var e=0;1==(e=null!=t?t:100*this.checkAssetsList/this.assetsList.length/100)&&(e=.99),ctx.fillStyle="#008080ff",ctx.fillRect(0,0,canvas.width,canvas.height),ctx.beginPath(),ctx.lineWidth="2",ctx.strokeStyle="#FFFFFF",ctx.beginPath(),x=canvas.width/2-160,y=canvas.height/2+200,ctx.moveTo(x,y),ctx.lineTo(x+300,y),ctx.quadraticCurveTo(x+310,y+15,x+300,y+30),ctx.lineTo(x,y+30),ctx.quadraticCurveTo(x-10,y+15,x,y),ctx.stroke(),x+=5,y+=5,ctx.beginPath(),ctx.moveTo(x,y),ctx.lineTo(e*x+290,y),ctx.lineTo(e*x+290,y+20),ctx.lineTo(x,y+20),ctx.quadraticCurveTo(x-10,y+10,x,y),ctx.fillStyle="#FFFFFF",ctx.fill(),img=document.getElementById("logohtml"),ctx.drawImage(img,canvas.width/2-150,canvas.height/2-220,300,350),ctx.font="15px Verdana",text=parseInt(100*e)+"%",ctx.textAlign="center",ctx.fillText("Loaded "+text,canvas.width/2,canvas.height/2+250)},ManagerMouse.prototype.start=function(){var e=this;canvas.addEventListener("click",function(t){for(var e=t.pageX-canvas.offsetLeft,o=t.pageY-canvas.offsetTop,n=se.mlevel.getObjectsCurrentLevel(),i=0;i<n.length;i++){if(element=n[i],"dragdrop"!=element.classename||element.dragdroped){if("button"==element.classename&&o>element.y&&o<element.y+element.h&&e>element.x&&e<element.x+element.w){element.click();break}}else if(o>element.y&&o<element.y+element.h&&e>element.x&&e<element.x+element.w){element.click();break}i==n.length-1&&(se.mlevel.offDragdropFlag(),console.log("off"))}},!1),canvas.addEventListener("mousemove",function(t){e.x=t.pageX-canvas.offsetLeft,e.y=t.pageY-canvas.offsetTop},!1)},ManagerMouse.prototype.getMousePosition=function(){return{x:this.x,y:this.y}},ManagerMouse.prototype.getMouseX=function(){return this.x},ManagerMouse.prototype.getMouseY=function(){return this.y},ManagerStorage=function(){},ManagerStorage.prototype.setItem=function(t,e){localStorage.setItem(t,e)},ManagerStorage.prototype.getItem=function(t){return localStorage.getItem(t)},ManagerStorage.prototype.setItemJSON=function(t,e){localStorage.setItem(t,JSON.stringify(e))},ManagerStorage.prototype.getItemJSON=function(t,e){return JSON.parse(localStorage.getItem(t))},Turtle.prototype.penDown=function(){this.stakemoviment.push([0,"pendown"])},Turtle.prototype.penUp=function(){this.stakemoviment.push([0,"penup"])},Turtle.prototype.changeToneFor=function(t){this.color.r+=t,this.color.g+=t,this.color.b+=t,255<this.color.r&&(this.color.r=this.color.r-255),255<this.color.g&&(this.color.g=this.color.g-255),255<this.color.b&&(this.color.b=this.color.b-255),this.stakemoviment.push(["rgb("+this.color.r+","+this.color.g+","+this.color.b+")","changecolor"])},Turtle.prototype.changeColorTo=function(t,e,o){this.color=null==e&&null==o?t:{r:t,g:e,b:o},255<this.color.r&&(this.color.r=this.color.r-255),255<this.color.g&&(this.color.g=this.color.g-255),255<this.color.b&&(this.color.b=this.color.b-255),this.stakemoviment.push(["rgb("+this.color.r+","+this.color.g+","+this.color.b+")","changecolor"])},Turtle.prototype.changeColorFor=function(t){this.changecolorup?("r"!=this.lastcolor&&255!=this.color.r?(this.color.r+=t,255<this.color.r&&(this.color.r=255,this.lastcolor="r")):"g"!=this.lastcolor&&255!=this.color.g?(this.color.g+=t,255<this.color.g&&(this.color.g=255,this.lastcolor="g")):"b"!=this.lastcolor&&255!=this.color.b&&(this.color.b+=t,255<this.color.b&&(this.color.b=255,this.lastcolor="b")),255==this.color.r&&255==this.color.g&&255==this.color.b&&(this.changecolorup=!1)):("r"!=this.lastcolor&&0!=this.color.r?(this.color.r-=t,this.color.r<0&&(this.color.r=0,this.lastcolor="r")):"g"!=this.lastcolor&&0!=this.color.g?(this.color.g-=t,this.color.g<0&&(this.color.g=0,this.lastcolor="g")):"b"!=this.lastcolor&&0!=this.color.b&&(this.color.b-=t,this.color.b<0&&(this.color.b=0,this.lastcolor="b")),0==this.color.r&&0==this.color.g&&0==this.color.b&&(this.changecolorup=!0)),this.stakemoviment.push(["rgb("+this.color.r+","+this.color.g+","+this.color.b+")","changecolor"])},Turtle.prototype.changeSizeTo=function(t){this.linew=t,this.stakemoviment.push([this.linew,"changesize"])},Turtle.prototype.changeSizeFor=function(t){this.linew+=t,this.stakemoviment.push([this.linew,"changesize"])},Turtle.prototype.print=function(){},Turtle.prototype.clean=function(){this.stakemoviment.push([this.stakemoviment.length,"clean"])},Turtle.prototype.forward=function(t){this.stakemoviment.push([t,"forward"])},Turtle.prototype.back=function(t){this.stakemoviment.push([t,"back"])},Turtle.prototype.left=function(t){this.stakemoviment.push([-t,"left"])},Turtle.prototype.right=function(t){this.stakemoviment.push([t,"right"])},Turtle.prototype.update=function(){this.pintaldline(),0<this.stakemoviment.length&&(movetox=this.x,movetoy=this.y,"pendown"==this.stakemoviment[0][1]?(this.stakealdlines.push(this.stakemoviment[0]),this.pendown=!0,this.stakemoviment.splice(0,1)):"penup"==this.stakemoviment[0][1]?(this.stakealdlines.push(this.stakemoviment[0]),this.pendown=!1,this.stakemoviment.splice(0,1)):"changecolor"==this.stakemoviment[0][1]?(this.stakealdlines.push(this.stakemoviment[0]),this.stakemoviment.splice(0,1)):"changesize"==this.stakemoviment[0][1]?(this.stakealdlines.push(this.stakemoviment[0]),this.stakemoviment.splice(0,1)):"clean"==this.stakemoviment[0][1]?(this.stakealdlines.push(this.stakemoviment[0]),this.stakemoviment.splice(0,1)):"right"==this.stakemoviment[0][1]||"left"==this.stakemoviment[0][1]?(this.stakealdlines.push([this.stakemoviment[0][0],this.stakemoviment[0][1],movetox,movetoy]),ctx.translate(movetox,movetoy),ctx.rotate(this.stakemoviment[0][0]*Math.PI/180),ctx.translate(-movetox,-movetoy),this.stakemoviment.splice(0,1)):"forward"!=this.stakemoviment[0][1]&&"back"!=this.stakemoviment[0][1]||("forward"==this.stakemoviment[0][1]?this.y-=this.velocity:"back"==this.stakemoviment[0][1]&&(this.y+=this.velocity),this.stepcurrent+=this.velocity,this.pendown&&(ctx.beginPath(),ctx.moveTo(movetox,movetoy),ctx.lineTo(this.x,this.y),ctx.strokeStyle="rgb("+this.color.r+","+this.color.g+","+this.color.b+")",ctx.stroke(),ctx.closePath()),this.stepcurrent>=this.stakemoviment[0][0]?(this.stakemoviment.splice(0,1),this.stepcurrent=0,this.stakealdlines[this.stakealdlines.length-1][2]=this.x,this.stakealdlines[this.stakealdlines.length-1][3]=this.y,this.isnewcommand=!0):this.isnewcommand?(this.isnewcommand=!1,this.stakealdlines.push([movetox,movetoy,this.x,this.y,this.stakemoviment[0][1]])):(this.stakealdlines[this.stakealdlines.length-1][2]=this.x,this.stakealdlines[this.stakealdlines.length-1][3]=this.y)),this.imgturtle.setPosition(this.x-this.imgturtle.getWidth()/2,this.y-this.imgturtle.getHeight()),this.imgturtle.print())},Turtle.prototype.pintaldline=function(){ctx.save(),ctx.setTransform(1,0,0,1,0,0);for(var t=0;t<this.stakealdlines.length;t++)"pendown"!=this.stakealdlines[t][1]?"penup"!=this.stakealdlines[t][1]?"changecolor"!=this.stakealdlines[t][1]?"changesize"!=this.stakealdlines[t][1]?"clean"!=this.stakealdlines[t][1]?"right"!=this.stakealdlines[t][1]&&"left"!=this.stakealdlines[t][1]?this.penolddown&&("forward"==this.stakealdlines[t][4]?(ctx.beginPath(),ctx.moveTo(this.stakealdlines[t][0],this.stakealdlines[t][1]),ctx.lineTo(this.stakealdlines[t][2],this.stakealdlines[t][3]),ctx.strokeStyle=this.stroke,ctx.stroke(),ctx.closePath()):"back"==this.stakealdlines[t][4]&&(ctx.beginPath(),ctx.moveTo(this.stakealdlines[t][2],this.stakealdlines[t][3]),ctx.lineTo(this.stakealdlines[t][0],this.stakealdlines[t][1]),ctx.strokeStyle=this.stroke,ctx.stroke(),ctx.closePath())):(ctx.translate(this.stakealdlines[t][2],this.stakealdlines[t][3]),ctx.rotate(this.stakealdlines[t][0]*Math.PI/180),ctx.translate(-this.stakealdlines[t][2],-this.stakealdlines[t][3])):this.stakealdlines.slice(0,this.stakealdlines[t][0]):ctx.lineWidth=this.stakealdlines[t][0]:ctx.strokeStyle=this.stakealdlines[t][0]:this.penolddown=!1:this.penolddown=!0;0==this.stakemoviment.length&&(this.imgturtle.setPosition(this.x-this.imgturtle.getWidth()/2,this.y-this.imgturtle.getHeight()),this.imgturtle.print()),ctx.restore()},StarterEngine=function(t,e){this.width=t,this.height=e,this.debugmode=!1,this.starterlogo=null,window.onload=function(){window.canvas=document.getElementById("gamecanvas"),window.ctx=canvas.getContext("2d"),this.mlevel=new ManagerLevel,this.mmouse=new ManagerMouse,this.loader=new ManagerLoader(function(){this.gameReady(),this.startGame()}.bind(this)),this.teclado=new ManagerInputs,this.storage=new ManagerStorage,this.setResources(),this.beginLoad()}.bind(this),red={r:255,b:0,g:0},green={r:0,b:0,g:255},blue={r:0,b:255,g:0},yellow={r:255,b:0,g:255},cian={r:0,b:255,g:255},black={r:0,b:0,g:0},white={r:255,b:255,g:255},orange={r:255,b:0,g:150},purple={r:255,b:255,g:0},gray={r:255,b:0,g:0}},StarterEngine.prototype.beginLoad=function(){this.loader.loading()},StarterEngine.prototype.startGame=function(){(this.mlevel.currentLevel=0)<this.mlevel.levels.length&&this.mlevel.currentLevel<this.mlevel.levels.length?(this.mlevel.levels[this.mlevel.currentLevel].startFunction(),this.loopgame(ctx)):console.error("Você precisa adicionar ao menos um Level!")},StarterEngine.prototype.loopgame=function(t){this.mlevel.print(t),requestAnimFrame(function(){se.loopgame(t)})},StarterEngine.prototype.gameReady=function(){},StarterEngine.prototype.setResources=function(){},StarterEngine.prototype.startTurtle=function(){this.setResources=function(){this.loader.addStarterResource("turtle","turtle.png","image")},this.gameReady=function(){var t=new Levels;t.setFunctionStart(setTurtle),se.mlevel.addLevel(t)}},window.requestAnimFrame=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(t){window.setTimeout(t,1e3/60)};